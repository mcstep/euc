<p id="notice">
	<%= notice %>
</p>
<p>
	<strong>Code:</strong>
	<%= @reg_code.code %>
</p>
<p>
	<strong>Valid from:</strong>
	<%= @reg_code.valid_from %>
</p>
<p>
	<strong>Valid to:</strong>
	<%= @reg_code.valid_to %>
</p>
<p>
	<strong>Status:</strong>
	<%= @reg_code.status ? "Enabled" : "Disabled" %>
</p>
<p>
	<strong>Registrations:</strong>
	<%= @reg_code.registrations %>
</p>
<p>
	<strong>Account type:</strong>
	<%= @reg_code.account_type %>
</p>
<p>
	<strong>Account validity:</strong>
	<%= @reg_code.account_validity %>
</p>

<% @invitations = Invitation.where("reg_code_id = #{@reg_code.id}") %>
<div> There are a total of <%= @invitations.count %> active users using this reg code</div>
<br/>

<table class="table table-striped table-bordered table-condense">
	<thead>
		<tr>
			<th>Full Name</th>
			<th>Email</th>
			<th>Username</th>
			<th>Title</th>
			<th>Company</th>
			<th>Region</th>
			<th>Expires on</th>
			<th>Reg Code</th>
			<th colspan="2"></th>
		</tr>
	</thead>
	<tbody>
		<% @invitations.each do |invitation| %>
			<tr>
				<td><%= invitation.recipient_firstname + " " + invitation.recipient_lastname %></td>
				<td><%= invitation.recipient_email %></td>
				<td><%= invitation.recipient_username %></td>
				<td><%= invitation.recipient_title %></td>
				<td><%= invitation.recipient_company %></td>
				<td><%= invitation.region %></td>
				<td>
					<%= (invitation.expires_at).to_date.to_formatted_s(:long) %>
					<a class="extend-account-link" href="#" data-toggle="modal" data-id="<%= invitation.id.to_s + ";" + invitation.recipient_firstname + " " + invitation.recipient_lastname + ";" + invitation.expires_at.to_s %>" data-target="#extend-account-modal" class="extend-user invite-user-link popoverExtendAccount" rel="popover" data-trigger="hover" data-placement="bottom"><span> (Extend)</span></a>
				</td>
				<td><%= @reg_code.code.upcase %></td>
				<td><%= link_to 'Delete', invitation, method: :delete, data: { confirm: 'Do you want to delete this account? The users account will permanently be deleted.' } %></td>
				<td><%= link_to 'Impersonate', impersonate_user_path(invitation.id), method: :post, data: { confirm: 'Do you want to impersonate this user?' } %></td>
			</tr>
		<% end %>
	</tbody>
</table>

<br/>
<%= link_to 'Edit', edit_reg_code_path(@reg_code) %> |
<%= link_to 'Back', reg_codes_path %>
