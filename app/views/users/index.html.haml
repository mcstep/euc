.col-md-12.col-sm-12.col-lg-12
  .panel.panel-default
    = form_tag users_path, method: :get, id: 'invitations-search-form', class: 'panel-body' do |f|
      %a.btn.btn-success.pull-left{href: '#', data: {target: "#invite-modal", toggle: "modal"}}
        Invite user
      .input-group
        %input.form-control{name: "search", placeholder: "Search users...", type: "text", value: params[:search]}
        %span.input-group-btn
          %button.btn.btn-default{type: "submit"} Search!

  .panel.panel-default
    .panel-heading
      %h3.panel-title
        = pluralize @users.size, 'user'
        found

    %table.table.table-striped.table-bordered
      %thead
        %tr
          %th Full Name
          %th Username
          %th Email
          %th Company
          %th Title
          %th Region
          %th Expires on
          %th Invited by
          %th
      %tbody
        - @users.each do |user|
          %tr
            %td= user.display_name
            %td= user.authentication_integration.username
            %td= user.email
            %td= user.company_name
            %td= user.job_title
            %td= I18n.t "regions.#{user.home_region}"
            %td= l user.expiration_date
            %td
              - if user.invited_by
                = user.invited_by.display_name
              - else
                .help-block
                  N/A
            %td{style: 'width: 1%; white-space: nowrap'}
              %a.btn.btn-xs.btn-success{href: user_path(user)}
                Activity
              - if policy(user).impersonate?
                %a.btn.btn-primary.btn-xs{href: impersonate_user_path(user), method: :post, data: { confirm: 'Do you want to impersonate this user?' }}
                  Impersonate
              %a.btn.btn-warning.btn-xs.manage-link{href: '#', data:{target: "#manage-modal", toggle: 'modal', url: edit_user_path(user) }}
                %span Manage
              %a.prolong-account-link.btn.btn-warning.btn-xs{href: '#', data: {target: "#prolong-account-modal", toggle: 'modal', id: user.authentication_integration.id, username: user.authentication_integration.username, date: bl(user.prolong_date), name: user.display_name}}
                Extend
              - if policy(user).destroy?
                %a{href: user_path(user), class: 'btn btn-danger btn-xs', data: {confirm: "Do you want to delete this account? The users account will permanently be deleted.", method: "delete"}}
                  Delete
              - if policy(user).recover?
                %a{href: recover_user_path(user), class: 'btn btn-danger btn-xs', data: {confirm: "Do you want to reset password for this account? The user will be notified by email.", method: "post"}}
                  Recover
    - if @users.num_pages > 1
      .panel-footer
        = paginate @users, theme: 'twitter-bootstrap-3'

  #manage-modal.modal.fade{role: "dialog", tabindex: "-1"}
    .modal-dialog
      .modal-content